<!DOCTYPE html>
<html lang='ja'>
<head>
<title>君もelixirを始めてみないか | dev.wan.co</title>
<meta charset='utf-8'>
<meta content='' name='keywords'>
<meta content='' name='description'>
<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600' rel='stylesheet' type='text/css'>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
  ga('create', 'UA-43663109-1', 'k-shogo.github.io');
  ga('send', 'pageview');
</script>

<!--[if lte IE 8]> <script src="js/html5shiv.js"></script> <![endif]-->
<script src="/js/all.js" type="text/javascript"></script>
<link href="/css/main.css" rel="stylesheet" type="text/css" />
</head>
<body>
<noscript>
<link href="/css/skel-noscript.css" rel="stylesheet" type="text/css" /><link href="/css/style.css" rel="stylesheet" type="text/css" /><link href="/css/style-desktop.css" rel="stylesheet" type="text/css" /><link href="/css/style-noscript.css" rel="stylesheet" type="text/css" />
</noscript>
<!--[if lte IE 8]> <link rel="stylesheet" href="css/ie8.css" /> <![endif]-->
<!-- Header -->
<div id='header'>
<!-- Inner -->
<div class='inner'>
<header>
<h1>
<div id='logo'><a href="/">Dev.Wan.Co</a></div>
</h1>
</header>
</div>
<!-- Nav -->
<nav id='nav'>
<ul>
<li>
<a href="/">Home</a>
</li>
<li>
<a href="/feed.xml">RSS Feed</a>
</li>
</ul>
</nav>
</div>
<!-- Main -->
<div class='wrapper style1'>
<div class='container'>
<div class='row'>
<div class='12u skel-cell-important' id='content'>
<article class='special' id='main'>
<header>
<h2>君もelixirを始めてみないか</h2>
<span class='byline'>
<a href="/article/tags/elixir/">elixir</a>
</span>
</header>
<section><header><h3>elixirって何？</h3></header>

<p><a href="http://elixir-lang.org">elixir</a> (エリクサー)は<a href="http://www.erlang.org">Erlang</a>で作られた言語なんだ。<br>
最初はCoffeeScriptとJavaScriptみたいな関係なのかって思ってくれれば良い。<br>
Erlangの上に作られているから、elixirの特徴を語るにはまずErlangについて述べる必要がある。</p>

<p>Erlangは1986年にJoe Armstrong, Robert Virding, Mike Williams の3人によって最初のバージョンが作られた。<br>
元々は通信機器メーカーのEricsson内部の独自言語だったけれど、1998年にオープンソースとしてリリースされた。<br>
Erlangの特徴をぎゅっとまとめると、並行性と信頼性そしてホットスワップだ。<br>
Erlangの開発は Joe Armstrong 博士が電話交換制御用ソフトウェアを構築するために、<br>
Prologをベースに並行プロセスやエラー処理の仕組みを追加したことに端を発している。<br>
並行性と信頼性、ホットスワップの特徴は通信事業者向けの分散アプリケーションの開発に必要だったんだ。</p>

<p>elixirはBEAMと呼ばれるErlangの仮想環境で動作するから、Erlangの並行性と信頼性の特徴を受け継いでいる。<br>
そして拡張機能としてマクロを使ったメタプログラミング等も扱うことが出来るんだ。</p>

<p>elixirよりまず、Erlangの知名度も高くは無いよね。<br>
でも案外身近なところで使われてたりするんだ。<br>
Twitterでは<a href="https://www.ejabberd.im">ejabberd</a>というJabber/XMPP実装が使われている（今現在もそうかは分からないけど）ようだし、<a href="https://www.erlang-solutions.com/about/news/whatsapp-engineers-talk-about-scaling-450-million-users-erlang-erlang-factory-sf-bay-6-7">WhatsAppもErlangを使用しているみたいだ</a>。<br>
Erlangは何億人とユーザーを抱えるような大規模なシステムでかなりの実績を積んでいる。<br>
プロセッサのマルチコア化が進む現在、並行性と信頼性を備えるErlangが活躍できる場面が多くなっていくんじゃないかなって思わないかい？<br>
Matzも注目する言語なんて記事もあるよ。</p>

<ul>
<li><a href="http://magazine.rubyist.net/?0017-Legwork">Rubyist Magazine - Rubyist のための他言語探訪 【第 10 回】 Erlang</a></li>
<li><a href="http://www.atmarkit.co.jp/news/200704/27/erlang.html">twitterブームの陰で注目を集める“Erlang” － ＠IT</a></li>
<li><a href="http://techon.nikkeibp.co.jp/article/TOPCOL/20070710/135665/">組み込みから生まれた言語Erlangの時代が来る - 日経エレクトロニクス - 日経テクノロジーオンライン</a></li>
</ul>

<p>そんなに言うならelixirじゃなくて素のErlangで良いじゃんって思うかもしれないね。<br>
答える代わりに質問だ、上の記事は2007の物なんだけど、Erlangって今流行ってる？<br>
ちょっとこの記事を見て欲しい&quot;<a href="http://www.infoq.com/jp/news/2012/01/Katz-CouchDB-Couchbase-Server">Damien Katz氏がApache CouchDBから離反し、Couchbase Server開発を継続</a>&ldquo;CouchDBがコードの大半をErlangからC/C++するって内容だ。<br>
Damien Katz氏はインタビューの中で流行ってない原因を述べている。</p>

<blockquote>
<p>Erlangは素晴らしい言語です。信頼性が高く、信頼できるしっかりとしたシステムを簡単に構築できます。しかし、エコシステムがとても小さいです。なので、ツールや性能に対する投資は他の一般的な言語とは比べようもないくらい少ないです。私はErlangにもっと人気の言語になって欲しいと思います。ErlangがJavaよりも速くならない理由はどこにもありません。しかし、その奇妙な構文が人々を遠ざけ、普及と商用投資を妨げています。でも私はErlangが好きです。性能が重要なコンポーネントでの利用は少なくしますが、今後も致命的に重要なコンポーネントに使うつもりです。</p>
</blockquote>

<p>そう、流行らないのは取っつきにくいからだ。<br>
であれば、取っつきやすければ Erlang のパワーを享受できるようになるね。<br>
そういう考えで始まったプロジェクトには<a href="http://reia-lang.org/">Reia Programming Language</a>という物もある、しかし残念ながらReiaの開発は停止してしまっている。<br>
Reiaの後に登場し、後継のプロジェクトに指名され、2014年9月18日にv1.0.0がリリースされたのがelixirなんだ。</p>

</section><section><header><h3>開発環境は整ってるの？</h3></header>

<p>何が取っつきやすくなったかって、それはもちろん文法なんだけど、<br>
今や言語そのものが良くたって開発環境が良くないと流行らないよね。<br>
だから文法の前に開発の環境について紹介しておくね。<br>
僕は普段はrubyを使っているから、rubyの環境と対比させて紹介するね。</p>

<p>まずは <code>Mix</code> だ。<br>
<code>Mix</code> は ruby だと <code>rake</code> と <code>bundler</code> を合わせたようなものなんだ。<br>
rubyのプロジェクト開始は <code>bundle init</code> して、<code>Gemfile</code> を編集して、<code>bundle install</code>するよね。</p>
<pre class="highlight shell"><code><span class="gp">$ </span>mkdir ruby_app
<span class="gp">$ </span><span class="nb">cd </span>ruby_app
<span class="gp">$ </span>bundle init
<span class="gp">$ </span>vim Gemfile
</code></pre>
<pre class="highlight ruby"><code><span class="n">source</span> <span class="s2">"https://rubygems.org"</span>

<span class="n">gem</span> <span class="s2">"rails"</span>
</code></pre>
<pre class="highlight shell"><code><span class="gp">$ </span>bundle install
</code></pre>

<p><code>elixir</code> の <code>mix</code> の場合は <code>mix new elixir_app</code> して <code>mix.exs</code> の <code>deps</code> を編集して、<code>mix deps.get</code> だ。<br>
ここでは <code>deps</code> に <a href="https://github.com/elixir-lang/ecto">elixir-lang/ecto</a> というライブラリを追加している。</p>
<pre class="highlight shell"><code><span class="gp">$ </span>mix new elixir_app
<span class="gp">$ </span><span class="nb">cd </span>elixir_app
<span class="gp">$ </span>vim mix.exs
</code></pre>
<pre class="highlight elixir"><code><span class="k">defmodule</span> <span class="no">ElixirApp</span><span class="o">.</span><span class="no">Mixfile</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">Mix</span><span class="o">.</span><span class="no">Project</span>

  <span class="k">def</span> <span class="n">project</span> <span class="k">do</span>
    <span class="p">[</span><span class="ss">app:</span> <span class="ss">:elixir_app</span><span class="p">,</span>
     <span class="ss">version:</span> <span class="sd">"</span><span class="s2">0.0.1"</span><span class="p">,</span>
     <span class="ss">elixir:</span> <span class="sd">"</span><span class="s2">~&gt; 1.0"</span><span class="p">,</span>
     <span class="ss">deps:</span> <span class="n">deps</span><span class="p">]</span>
  <span class="k">end</span>

  <span class="c1"># Configuration for the OTP application</span>
  <span class="c1">#</span>
  <span class="c1"># Type `mix help compile.app` for more information</span>
  <span class="k">def</span> <span class="n">application</span> <span class="k">do</span>
    <span class="p">[</span><span class="ss">applications:</span> <span class="p">[</span><span class="ss">:logger</span><span class="p">]]</span>
  <span class="k">end</span>

  <span class="c1"># Dependencies can be Hex packages:</span>
  <span class="c1">#</span>
  <span class="c1">#   {:mydep, "~&gt; 0.3.0"}</span>
  <span class="c1">#</span>
  <span class="c1"># Or git/path repositories:</span>
  <span class="c1">#</span>
  <span class="c1">#   {:mydep, git: "https://github.com/elixir-lang/mydep.git", tag: "0.1.0"}</span>
  <span class="c1">#</span>
  <span class="c1"># Type `mix help deps` for more examples and options</span>
  <span class="k">defp</span> <span class="n">deps</span> <span class="k">do</span>
    <span class="p">[</span>
      <span class="p">{</span><span class="ss">:ecto</span><span class="p">,</span> <span class="sd">"</span><span class="s2">~&gt; 0.4"</span><span class="p">}</span>
    <span class="p">]</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<pre class="highlight shell"><code><span class="gp">$ </span>mix deps.get
</code></pre>

<p>rubyでの<a href="https://rubygems.org/">RubyGems.org</a>に対応するライブラリのホスティングは<a href="https://hex.pm/">Hex</a>という物があるし、<br>
依存関係には <a href="https://github.com/">GitHub</a> のリポジトリを指定することも出来る。</p>

<p>インタラクティブシェルは <code>irb</code> に相当する <code>iex</code> が用意されているし、テストも標準で <code>ExUnit</code> という物がある。<br>
さらに、是非紹介しておきたいのが Elixir Release Manager <a href="https://github.com/bitwalker/exrm">bitwalker/exrm</a>だ。<br>
詳しい使い方は後に回すけれど、exrm はリリース用のビルドを行うことが出来るし、さらにダウンタイムなしのアップグレードやダウングレードを簡単にしてくれる。</p>

<table><thead>
<tr>
<th style="text-align: left">機能</th>
<th style="text-align: left">ruby</th>
<th style="text-align: left">elixir</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: left">ビルドツール</td>
<td style="text-align: left">rake</td>
<td style="text-align: left">mix</td>
</tr>
<tr>
<td style="text-align: left">ライブラリ管理</td>
<td style="text-align: left">bundle</td>
<td style="text-align: left">mix</td>
</tr>
<tr>
<td style="text-align: left">標準リポジトリ</td>
<td style="text-align: left">RubyGems.org</td>
<td style="text-align: left">Hex</td>
</tr>
<tr>
<td style="text-align: left">インタラクティブシェル</td>
<td style="text-align: left">irb</td>
<td style="text-align: left">iex</td>
</tr>
<tr>
<td style="text-align: left">テスト</td>
<td style="text-align: left">minitest</td>
<td style="text-align: left">ExUnit</td>
</tr>
</tbody></table>

<p>エディターのサポートは、vim(<a href="https://github.com/elixir-lang/vim-elixir">vim elixir-lang/vim-elixir</a>)と emacs(<a href="https://github.com/elixir-lang/emacs-elixir">elixir-lang/emacs-elixir</a>)とAtom(<a href="https://github.com/lucasmazza/language-elixir">lucasmazza/language-elixir</a>)があるから大丈夫かな？（他にもgeditとTextmateも用意されているよ）</p>

</section><section><header><h3>はじめてみよう</h3></header>

<p>始めて見るにはまずelixirをインストールしないとね。<br>
もしMacを使っていて、すでに<code>brew</code>を使っているのであればとても簡単</p>
<pre class="highlight shell"><code><span class="gp">$ </span>brew update
<span class="gp">$ </span>brew install elixir
</code></pre>

<p>Ubuntu を使っているなら、リポジトリを追加して<code>apg-get</code>で入る</p>
<pre class="highlight shell"><code><span class="gp">$ </span>wget http://packages.erlang-solutions.com/erlang-solutions_1.0_all.deb <span class="o">&amp;&amp;</span> sudo dpkg -i erlang-solutions_1.0_all.deb
<span class="gp">$ </span>sudo apt-get update
<span class="gp">$ </span>sudo apt-get install elixir
</code></pre>

<p>Windowsの場合は<a href="http://s3.hex.pm/elixir-websetup.exe">インストーラー</a>が用意されているよ。</p>

<p>これで基本的にはErlangも一緒に入っている。<br>
早速使い始めてみよう。<code>iex</code>コマンドでインタラクティブシェルが立ち上がる</p>
<pre class="highlight elixir"><code><span class="no">Erlang</span><span class="o">/</span><span class="no">OTP</span> <span class="m">17</span> <span class="p">[</span><span class="n">erts</span><span class="o">-</span><span class="m">6.3</span><span class="p">]</span> <span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="p">[</span><span class="m">64</span><span class="o">-</span><span class="n">bit</span><span class="p">]</span> <span class="p">[</span><span class="ss">smp:</span><span class="m">4</span><span class="p">:</span><span class="m">4</span><span class="p">]</span> <span class="p">[</span><span class="n">async</span><span class="o">-</span><span class="ss">threads:</span><span class="m">10</span><span class="p">]</span> <span class="p">[</span><span class="n">hipe</span><span class="p">]</span> <span class="p">[</span><span class="n">kernel</span><span class="o">-</span><span class="ss">poll:</span><span class="no">false</span><span class="p">]</span> <span class="p">[</span><span class="n">dtrace</span><span class="p">]</span>

<span class="no">Interactive</span> <span class="no">Elixir</span> <span class="p">(</span><span class="m">1.0</span><span class="o">.</span><span class="m">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">press</span> <span class="no">Ctrl</span><span class="o">+</span><span class="no">C</span> <span class="n">to</span> <span class="k">exit</span> <span class="p">(</span><span class="n">type</span> <span class="n">h</span><span class="p">()</span> <span class="no">ENTER</span> <span class="n">for</span> <span class="n">help</span><span class="p">)</span>
<span class="n">iex</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="o">&gt;</span>
</code></pre>

<p>終了したいときは<code>Ctrl+C</code>して<code>(a)bort</code>の<code>a</code>をタイプしてエンターだ。</p>

<p>実はErlang(<code>erl</code>で起動するよ)だと式の最後に<code>.</code>ピリオドを付けなきゃならない</p>
<pre class="highlight erlang"><code><span class="nv">Erlang</span><span class="o">/</span><span class="nv">OTP</span> <span class="mi">17</span> <span class="p">[</span><span class="n">erts</span><span class="o">-</span><span class="mi">6</span><span class="p">.</span><span class="mi">3</span><span class="p">]</span> <span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="p">[</span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="p">]</span> <span class="p">[</span><span class="nn">smp</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="p">[</span><span class="n">async</span><span class="o">-</span><span class="nn">threads</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="p">[</span><span class="n">hipe</span><span class="p">]</span> <span class="p">[</span><span class="n">kernel</span><span class="o">-</span><span class="nn">poll</span><span class="p">:</span><span class="n">false</span><span class="p">]</span> <span class="p">[</span><span class="n">dtrace</span><span class="p">]</span>

<span class="nv">Eshell</span> <span class="nv">V6</span><span class="p">.</span><span class="mi">3</span>  <span class="p">(</span><span class="n">abort</span> <span class="n">with</span> <span class="err">^</span><span class="nv">G</span><span class="p">)</span>
<span class="mi">1</span><span class="o">&gt;</span> <span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="p">.</span>
<span class="mi">3</span>
</code></pre>

<p>でもelixirならピリオドはいらない、そのまま<code>1+2</code>とタイプしてエンターで計算できる。</p>
<pre class="highlight elixir"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="m">1</span><span class="o">+</span><span class="m">2</span>
<span class="m">3</span>
</code></pre>

<p>このまま進む前に、elixirのインストールによって入った他のコマンドも紹介しておこう。<br>
<code>elixir</code>と<code>elixirc</code>だ。<br>
<code>elixir</code>コマンドはelixirスクリプトを実行する物だ。<br>
<code>ruby hoge.rb</code>みたいな感じで、<code>elixir hoge.exs</code>と使用する。<br>
<code>elixirc</code>はコンパイル用のコマンドで、<code>elixirc hoge.ex</code>とするとコンパイルされた<code>.beam</code>ファイルが生成される。<br>
ファイルの拡張子を<code>.exs</code>と<code>.ex</code>を登場させたけれど、<br>
<code>.exs</code>はコンパイルしないで実行するスクリプトファイル、<br>
<code>.ex</code>はコンパイルするファイルに付けるのが習慣なんだ。</p>

<p>他には今後よく使う表記について説明しておこう。<br>
elixirでは関数は&quot;モジュール名&rdquo;, &ldquo;関数名&rdquo;, &ldquo;アリティ&quot;（つまり引数の個数）によって一意に定まる。<br>
だから関数を表現するときに <code>モジュール.関数/アリティ</code>といった具合に表記する。<br>
例えば `IO.puts/1&rsquo; とかね。<br>
これはiexからドキュメントを見るときにも使うよ。</p>
<pre class="highlight elixir"><code><span class="n">iex</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">h</span><span class="p">(</span><span class="no">IO</span><span class="o">.</span><span class="n">puts</span><span class="o">/</span><span class="m">1</span><span class="p">)</span>

                <span class="k">def</span> <span class="n">puts</span><span class="p">(</span><span class="n">device</span> <span class="p">\\</span> <span class="ss">:erlang</span><span class="o">.</span><span class="n">group_leader</span><span class="p">(),</span> <span class="n">item</span><span class="p">)</span>

<span class="no">Writes</span> <span class="n">the</span> <span class="n">argument</span> <span class="n">to</span> <span class="n">the</span> <span class="n">device</span><span class="p">,</span> <span class="n">similar</span> <span class="n">to</span> <span class="n">write</span><span class="o">/</span><span class="m">2</span><span class="p">,</span> <span class="n">but</span> <span class="n">adds</span> <span class="n">a</span> <span class="n">newline</span> <span class="n">at</span>
<span class="n">the</span> <span class="k">end</span><span class="o">.</span> <span class="no">The</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">chardata</span><span class="o">.</span>
</code></pre>

</section><section><header><h3>まずは基本的な型だ</h3></header>

<h4>整数、浮動小数、文字列</h4>

<p>基本的な型を確認してみよう</p>
<pre class="highlight elixir"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="m">1</span><span class="o">+</span><span class="m">2</span>
<span class="m">3</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="m">1</span><span class="o">+</span><span class="m">2.0</span>
<span class="m">3.0</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="sd">"</span><span class="s2">string"</span>
<span class="sd">"</span><span class="s2">string"</span>
</code></pre>

<p>整数、浮動小数点、文字列が使えることが分かった。<br>
整数と浮動小数点の計算ではエラーにならずに自動的に型の変換もしてくれる。<br>
ちなみにelixirの浮動小数点は64ビットの倍精度だ。<br>
四則演算は当然出来るんだけど、ちょっと注意なのが<code>/</code>による除算だ。<br>
irbで<code>10 / 3</code>とやれば<code>3</code>が出力されるけど、iexなら浮動小数点で返る。<br>
整数の商が欲しければ<code>div</code>関数が用意されている。<br>
rubyと同じで自明なカッコは省略も出来る。</p>
<pre class="highlight elixir"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="m">10</span> <span class="o">/</span> <span class="m">3</span>
<span class="m">3.3333333333333335</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">div</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
<span class="m">3</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">div</span> <span class="m">10</span><span class="p">,</span> <span class="m">3</span>
<span class="m">3</span>
</code></pre>

<p>二進数、八進数、十六進数、そして指数表記もサポートしている。</p>
<pre class="highlight elixir"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="m">0b11111011111</span>
<span class="m">2015</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="err">0</span><span class="n">o77</span>
<span class="m">63</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="m">0xff</span>
<span class="m">255</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="m">1.0e-10</span>
<span class="m">1.0e-10</span>
</code></pre>

<h4>真偽値</h4>

<p>真偽値は<code>true</code>,<code>false</code>だ。</p>
<pre class="highlight elixir"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="no">true</span>
<span class="no">true</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">false</span>
<span class="no">false</span>
</code></pre>

<p>ここまで紹介してきた型は<code>is_integer/1</code>, <code>is_float/1</code>, <code>is_number/1</code>, <code>is_boolean/1</code> で判定できるよ。<br>
<code>is_number/1</code>は整数もしくは浮動小数点の場合に<code>true</code>だね。</p>
<pre class="highlight elixir"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="n">is_number</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
<span class="no">true</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">is_number</span><span class="p">(</span><span class="m">1.0</span><span class="p">)</span>
<span class="no">true</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">is_number</span><span class="p">(</span><span class="no">true</span><span class="p">)</span>
<span class="no">false</span>
</code></pre>

<h4>アトム</h4>

<p>次はアトムだ。アトムは<code>:</code>から始まるもので、rubyだとシンボルって呼ばれているね。<br>
真偽値の<code>true</code>, <code>false</code>は実はアトムなんだ。</p>
<pre class="highlight elixir"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="no">true</span> <span class="o">==</span> <span class="ss">:true</span>
<span class="no">true</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">is_atom</span><span class="p">(</span><span class="no">false</span><span class="p">)</span>
<span class="no">true</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">is_boolean</span><span class="p">(</span><span class="ss">:false</span><span class="p">)</span>
<span class="no">true</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">is_atom</span><span class="p">(</span><span class="ss">:hoge</span><span class="p">)</span>
<span class="no">true</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">is_boolean</span><span class="p">(</span><span class="ss">:hoge</span><span class="p">)</span>
<span class="no">false</span>
</code></pre>

<h4>文字列の式展開 / 引用符による違い</h4>

<p>文字列は二重引用符で括って使う。<br>
rubyと同様に<code>#{}</code>によって式を展開することも出来る。<br>
単一引用符を使おうとすると、少し驚く結果となるだろう。</p>
<pre class="highlight elixir"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="sd">"</span><span class="s2">1 + 2 = </span><span class="si">#{</span><span class="m">1</span><span class="o">+</span><span class="m">2</span><span class="si">}</span><span class="s2">"</span>
<span class="sd">"</span><span class="s2">1 + 2 = 3"</span>
<span class="n">iex</span> <span class="s1">'日本語'</span>
<span class="p">[</span><span class="m">26085</span><span class="p">,</span> <span class="m">26412</span><span class="p">,</span> <span class="m">35486</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="sd">"</span><span class="s2">日本語"</span>
<span class="sd">"</span><span class="s2">日本語"</span>
</code></pre>

<p>これは文字列と文字のリストの違いが原因なんだ。</p>

<h4>リストとタプル</h4>

<p>単一引用符を使ったときに現れたものはリストなんだ。<br>
リストは<code>[]</code>を使って表現する。リストには何でも入れられる</p>
<pre class="highlight elixir"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="no">true</span><span class="p">,</span> <span class="ss">:atom</span><span class="p">,</span> <span class="sd">"</span><span class="s2">string"</span><span class="p">,</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">]]</span>
<span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="no">true</span><span class="p">,</span> <span class="ss">:atom</span><span class="p">,</span> <span class="sd">"</span><span class="s2">string"</span><span class="p">,</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">]]</span>
</code></pre>

<p>リストと似ているタプルという物もある。<br>
タプルもリストと同じように何でも入れられる</p>
<pre class="highlight elixir"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="p">{</span><span class="m">1</span><span class="p">,</span> <span class="no">true</span><span class="p">,</span> <span class="ss">:atom</span><span class="p">,</span> <span class="sd">"</span><span class="s2">string"</span><span class="p">,</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">],</span> <span class="p">{</span><span class="ss">:x</span><span class="p">,</span> <span class="ss">:y</span><span class="p">}}</span>
<span class="p">{</span><span class="m">1</span><span class="p">,</span> <span class="no">true</span><span class="p">,</span> <span class="ss">:atom</span><span class="p">,</span> <span class="sd">"</span><span class="s2">string"</span><span class="p">,</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">],</span> <span class="p">{</span><span class="ss">:x</span><span class="p">,</span> <span class="ss">:y</span><span class="p">}}</span>
</code></pre>

<p>似ているけれど、中身は違う。<br>
それはリストは中身が連結リスト（Linked list）であるのに対し、タプルは要素を連続したメモリ上に保存している点だ。<br>
タプルは連続したメモリ上に要素を持っているから、インデックスによる要素の取得や、要素数の取得は高速に出来る。<br>
対してリストは連結リストであるため、要素を順にたどる必要があり、タプルよりは低速になってしまう。<br>
リストの方が使い勝手が良い場合は要素を更新したり追加する時だ。<br>
elixrのデータ型は変更不可能なため、タプルの要素の更新はタプル全体をコピーしてから行う必要がある。<br>
リストの場合は途中の連結を変更するだけなので、タプルより簡単だ。<br>
リストとタプル、似てはいるけれど、適切に使い分けた方が良い。<br>
つまり変更されないような場合はタプル、変更される場合はリストといった具合だ。</p>

<p>リストとタプルについての操作も見てみよう。<br>
リストは<code>++/2</code>, <code>--/2</code>で連結や、差し引いたりが出来るし、<code>hd/1</code>, <code>tl/1</code>でリストの先頭とそれ以外の取得が出来る（LISPのcar, cdrみたいだね）。<br>
長さの取得は<code>length/1</code>を使う</p>
<pre class="highlight elixir"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]</span> <span class="o">++</span> <span class="p">[</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">]</span>
<span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]</span> <span class="o">--</span> <span class="p">[</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">]</span>
<span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">hd</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">]</span>
<span class="m">1</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">tl</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">]</span>
<span class="p">[</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">]</span>
<span class="n">length</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]</span>
<span class="m">3</span>
</code></pre>

<p>タプルのインデックスによる要素取得、サイズ取得、要素の変更はそれぞれ<code>elem/2</code>, <code>tuple_size/1</code>, <code>put_elem/3</code>を使う。</p>
<pre class="highlight elixir"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="n">elem</span><span class="p">({</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">},</span> <span class="m">1</span><span class="p">)</span>
<span class="m">2</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">tuple_size</span><span class="p">({</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">})</span>
<span class="m">3</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">put_elem</span><span class="p">({</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">},</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">)</span>
<span class="p">{</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">}</span>
</code></pre>

<p>リストの要素数取得が<code>length</code>で、タプルの要素数取得が<code>size</code>なのはちゃんと理由があるんだ。<br>
elixirではデータ構造が持っている要素数を数える場合、<br>
値があらかじめ計算されている場合は関数名に<code>size</code>を、明示的に計算が必要なものは関数名に<code>length</code>が使われている。<br>
自分で関数を作る場合にも気をつけてみよう。</p>

</section><section><header><h3>まだ追記していくよ</h3></header>
</section>
</article>
</div>
</div>
</div>
</div>
<div id='footer'>
<div class='container'>
<div class='row'>
<!-- Posts -->
<section class='6u'>
<header>
<h2 class='fa fa-angle-left circled solo'>
<span>Next Article</span>
</h2>
</header>
</section>
<!-- Posts -->
<section class='6u'>
<header>
<h2 class='fa fa-angle-right circled solo'>
<span>Prev Article</span>
</h2>
</header>
<ul class='divided'>
<li>
<article class='post stub'>
<header>
<h3>
<a href="/article/2014/12/16/rails-tips/">早く知っておけば良かったrailsの技</a>
</h3>
</header>
<span class='timestamp'>prev article</span>
</article>
</li>
</ul>
</section>
</div>
</div>
</div>

</body>
</html>
